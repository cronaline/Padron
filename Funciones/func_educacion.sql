--FUNCION QUE MUESTRA LA INFORMACION DE EDUCACION DE UN EMPLEADOS
--ENTRADA: ID DE LA PERSONA DE LA QUE SE DESEA OBTENER LA INFORMACION (INTEGER), NOMBRE DEL CURSOR DONDE ALMACENARA LA INFORMACION
--SALIDA: CURSOS CON LA INFORMACION REQUERIDA
CREATE OR REPLACE FUNCTION func_educacion(id integer, ref refcursor)
RETURNS refcursor AS $$
 BEGIN
   OPEN ref FOR SELECT EP.ID_EDUCACION_PERSONA, E.NOMBRE, E.DESCRIPCION, EP.FECHA_INICIO, EP.FECHA_FIN, O.NOMBRE, G.NOMBRE, EP.PROBATORIO
        FROM EDUCACION E
        JOIN EDUCACION_PERSONA EP
        ON E.ID_EDUCACION = EP.ID_EDUCACION
        JOIN ORGANIZACION O
        ON E.ID_ORGANIZACION = O.ID_ORGANIZACION
        JOIN GRADO G
        ON G.ID_GRADO = E.ID_GRADO
        WHERE ID_PERSONA = ID
        ORDER BY EP.ID_EDUCACION_PERSONA ASC;
   RETURN ref;
 END;
 $$ LANGUAGE plpgsql;

 BEGIN;
     SELECT FUNC_EDUCACION(1, 'EDUCACION');
     FETCH ALL IN "EDUCACION";
 COMMIT;
